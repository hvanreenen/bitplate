using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using BitPlate.Domain;
using BitPlate.Domain.Autorisation;
using BitPlate.Domain.Licenses;

namespace BitSite._bitPlate.DataCollections
{
    public partial class DataCollections : BasePage
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            base.CheckLoginAndLicense();

            base.CheckPermissions(FunctionalityEnum.DataCollections);

            if (SessionObject.CurrentSite.IsMultiLingual && SessionObject.CurrentLicense.AllowMultipleLanguages)
            {
                divLanguage.Visible = true;
                tdLangTitle.Visible = true;
                tdLanguageField.Visible = true;
                //vullen dropdown met talen
                //int selectedIndex = 0;
                //int index = 0;
                ListItem li = new ListItem( "***Taal per veld instellen***", "none");
                dropdownLanguages.Items.Add(li);
                foreach (CmsLanguage language in SessionObject.CurrentSite.Languages)
                {
                    ListItem listItem = new ListItem(language.Name, language.LanguageCode);
                    if (language.LanguageCode == SessionObject.CurrentSite.DefaultLanguage)
                    {
                        listItem.Attributes.Add("data-cms-default-language", "true");
                    }

                    dropdownLanguages.Items.Add(listItem);
                    //index++;
                }
                //dropdownLanguages.SelectedIndex = selectedIndex;
            }
            if (!SessionObject.HasPermission(FunctionalityEnum.DataCollectionsEditData))
            {
                tdDataCollectionData.Visible = false;
                htdDataCollectionData.Visible = false;
                //tdDataCollectionData.Disabled = true;
                //aDataCollectionData.HRef = "#";
            }
            if (!SessionObject.HasPermission(FunctionalityEnum.DataCollectionsConfig))
            {
                tdDataCollectionConfig.Visible = false;
                htdDataCollectionConfig.Visible = false;
                //tdDataCollectionConfig.Disabled = true;
                //aDataCollectionConfig.HRef = "#";
            }
            if (!SessionObject.HasPermission(FunctionalityEnum.DataCollectionsRemove))
            {
                tdDataCollectionRemove.Visible = false;
                htdDataCollectionRemove.Visible = false;
                //tdDataCollectionRemove.Disabled = true;
                //aDataCollectionRemove.HRef = "#";
            }
            if (!SessionObject.HasPermission(FunctionalityEnum.DataCollectionsCreate))
            {
                liAddDataCollection.Disabled = true;
                aAddDataCollection.HRef = "#";
                liAddDataCollection.Attributes["class"] = "bitItemDisabled";
                tdDataCollectionCopy.Visible = false;
                htdDataCollectionCopy.Visible = false;
                //tdDataCollectionCopy.Disabled = true;
                //aDataCollectionCopy.HRef = "#";
            }
            if (SessionObject.CurrentSite.IsMultiLingual && SessionObject.CurrentLicense.AllowMultipleLanguages)
            {
                tdGroupFieldMultiLanguageTitle.Visible = true;
                tdGroupFieldMultiLanguageRow.Visible = true;
                tdItemFieldMultiLanguageTitle.Visible = true;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                tdItemFieldMultiLanguageRow.Visible = true;
                divMultiLanguage.Visible = true;

                
                foreach (CmsLanguage language in SessionObject.CurrentSite.Languages)
                {
                    if (language.LanguageCode != SessionObject.CurrentSite.DefaultLanguage)
                    {
                        LiteralLookupValuesLanguages.Text += String.Format(@"<div class=""bitPageSettingsCollumnA"">{0}</div>
        <div class=""bitPageSettingsCollumnB"">
            <span class=""bitInfo"" title="""">Vertaal de waarde in de taal: {0}</span>
        </div>
        <div class=""bitPageSettingsCollumnC"">
            <input type=""text"" data-field=""{1}"" />
        </div>
        <br clear=""all"" />
        <!-- NEXT ROW -->
", language.Name, language.LanguageCode);
                        
                    }
                }
            }

        }
    }
}